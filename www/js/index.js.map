{"version":3,"sources":["webpack://sudoku/./js/index.js","webpack://sudoku/./js/core/checker.js","webpack://sudoku/./js/core/generator.js","webpack://sudoku/./js/core/sudoku.js","webpack://sudoku/./js/core/toolkit.js","webpack://sudoku/./js/ui/grid.js","webpack://sudoku/./js/ui/popupnumber.js","webpack://sudoku/webpack/bootstrap"],"names":["Grid","PopupNumbers","grid","popupNumbers","checkArray","array","length","marks","Array","fill","i","v","j","Toolkit","require","module","exports","matrix","this","_matrix","_matrixMarks","makeMatrix","checkRows","checkCols","checkBoxes","_success","every","row","mark","rowIndex","colIndex","cols","boxIndex","box","getBoxCells","cellIndex","convertFromBoxIndex","Generator","internalGenerate","console","log","orders","map","shuffle","from","n","fillNumber","fillRow","checkFillable","genterator","generate","solutionMatrix","level","puzzleMatrix","cell","Math","random","matrixToolkit","makeRow","endIndex","floor","column","boxToolkit","convertToBoxIndex","startRowIndex","startColIndex","result","push","Sudoku","Checker","container","_$container","sudoku","make","rowGroupClasses","colGroupClasses","$divArray","rowValues","cellValue","$","addClass","text","$spanArray","append","width","height","css","on","e","$cell","target","is","popup","empty","build","layout","data","children","div","span","parseInt","toArray","$data","checker","check","matrixMarks","each","$span","removeClass","find","$panel","_$panel","hide","_$targetCell","hasClass","position","left","top","bodyWidth","document","body","right","show","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","bindPopup","alert","reset","clear","rebuild"],"mappings":"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","file":"index.js","sourcesContent":["const Grid = require('./ui/grid.js')\r\nconst PopupNumbers = require('./ui/popupnumber.js')\r\n\r\nconst grid = new Grid($('#container'))\r\nconst popupNumbers = new PopupNumbers($('#popupNumbers'))\r\n\r\ngrid.build()\r\ngrid.layout()\r\ngrid.bindPopup(popupNumbers)\r\n\r\n$('#check').on('click', e => {\r\n  if (grid.check()) {\r\n    alert('成功')\r\n  }\r\n})\r\n\r\n$('#reset').on('click', e => {\r\n  grid.reset()\r\n})\r\n\r\n$('#clear').on('click', e => {\r\n  grid.clear()\r\n})\r\n\r\n$('#rebuild').on('click', e => {\r\n  grid.rebuild()\r\n})\r\n","// 检查数据\r\n\r\nfunction checkArray(array) {\r\n  const length = array.length\r\n  const marks = new Array(length)\r\n  marks.fill(true)\r\n\r\n  for(let i = 0; i < length; i++) {\r\n    if (!marks[i]) {\r\n      continue\r\n    }\r\n\r\n    const v = array[i]\r\n    // 是否有效:  0为无效   1-9为有效\r\n    if (!v) {\r\n      marks[i] = false\r\n      continue\r\n    }\r\n    // 是否重复: i+1 ~ 9 是否和 i 位置的数据重复\r\n    for (let j = i + 1; j < length; j++) {\r\n      if (v === array[j]) {\r\n        marks[i] = marks[j] = false\r\n      }\r\n    }\r\n  }\r\n  return marks\r\n}\r\n\r\nconst Toolkit = require('./toolkit.js')\r\n// 输入: matrix, 用户完成的数独数据, 9 * 9\r\n// 处理: 对 matrix 行、列、宫进行检查, 并填写 marks\r\n// 输出: 检查是否成功、marks\r\n\r\nmodule.exports = class Checker {\r\n  constructor(matrix) {\r\n    this._matrix = matrix\r\n    this._matrixMarks = Toolkit.matrix.makeMatrix(true)\r\n  }\r\n\r\n  get matrixMarks() {\r\n    return this._matrixMarks\r\n  }\r\n\r\n  get isSuccess() {\r\n    return this._success\r\n  }\r\n\r\n  check() {\r\n    this.checkRows()\r\n    this.checkCols()\r\n    this.checkBoxes()\r\n\r\n    // 检查是否成功\r\n    this._success = this._matrixMarks.every(row => row.every(mark => mark))\r\n    return this._success\r\n  }\r\n\r\n  checkRows() {\r\n    for(let rowIndex = 0; rowIndex < 9; rowIndex++) {\r\n      const row = this._matrix[rowIndex]\r\n      const marks = checkArray(row)\r\n      for (let colIndex = 0; colIndex < marks.length; colIndex++) {\r\n        if (!marks[colIndex]) {\r\n          this._matrixMarks[rowIndex][colIndex] = false\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  checkCols() {\r\n      for (let colIndex = 0; colIndex < 9; colIndex++) {\r\n        const cols = []\r\n        for (let rowIndex = 0; rowIndex < 9; rowIndex++) {\r\n          cols[rowIndex] = this._matrix[rowIndex][colIndex]\r\n        }\r\n        const marks = checkArray(cols)\r\n        for (let rowIndex = 0; rowIndex < marks.length; rowIndex++) {\r\n          if (!marks[rowIndex]) {\r\n            this._matrixMarks[rowIndex][colIndex] = false\r\n          }\r\n        }\r\n      }\r\n  }\r\n\r\n  checkBoxes() {\r\n    for (let boxIndex = 0; boxIndex < 9; boxIndex++) {\r\n      const boxes = Toolkit.box.getBoxCells(this._matrix, boxIndex)\r\n      const marks = checkArray(boxes)\r\n      for (let cellIndex = 0; cellIndex < 9; cellIndex++) {\r\n        if (!marks[cellIndex]) {\r\n          const {rowIndex, colIndex} = Toolkit.box.convertFromBoxIndex(boxIndex, cellIndex)\r\n          this._matrixMarks[rowIndex][colIndex] = false\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n\r\n// const Generator = require('./generator.js')\r\n// const gen = new Generator()\r\n// gen.generate()\r\n// const matrix = gen.matrix\r\n// const checker = new Checker(matrix)\r\n// console.log('check result', checker.check())\r\n// console.log(checker.matrixMarks)\r\n//\r\n// matrix[1][1] = 0\r\n// matrix[2][3] = matrix[3][5] = 5\r\n// const checker2 = new Checker(matrix)\r\n// console.log('check result', checker2.check())\r\n// console.log(checker2.matrixMarks)\r\n","// 生成数独解决方案\r\nconst Toolkit = require('./toolkit.js')\r\n\r\nclass Generator {\r\n  generate() {\r\n    while (!this.internalGenerate()) {\r\n      console.log('try again')\r\n    }\r\n  }\r\n  internalGenerate() {\r\n    //  入口方法\r\n    this.matrix = Toolkit.matrix.makeMatrix()\r\n    this.orders = Toolkit.matrix.makeMatrix()\r\n      .map(row => row.map((v, i) => i))\r\n      .map(row => Toolkit.matrix.shuffle(row))\r\n\r\n    // for (let n = 1; n <= 9; n++) { // 填写 1 - 9\r\n    //   if (!this.fillNumber(n)) {\r\n    //     return false\r\n    //   }\r\n    // }\r\n    // return true\r\n    return Array.from({ length: 9 }).every((n, i) => this.fillNumber(i + 1))\r\n  }\r\n\r\n  fillNumber(n) {\r\n    return this.fillRow(n, 0)\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param n  值\r\n   * @param rowIndex 行\r\n   */\r\n  fillRow(n, rowIndex) {\r\n    // console.log('rowIndex ==== ', rowIndex)\r\n    if (rowIndex > 8) {\r\n      return true\r\n    }\r\n\r\n    const row = this.matrix[rowIndex] // 值都为 0 的行\r\n    const orders = this.orders[rowIndex] // 值打乱的行\r\n    // console.log('orders', orders)\r\n    for (let i = 0; i < 9; i++) { // 遍历每一列\r\n      // const colIndex = i\r\n      const colIndex = orders[i] // 列号\r\n      // 如果这个位置已经有值, 跳过\r\n      if (row[colIndex]) {\r\n        // console.log('如果这个位置已经有值, 跳过')\r\n        continue\r\n      }\r\n\r\n      // 检查这个位置是否可以填 n\r\n      if (!Toolkit.matrix.checkFillable(this.matrix, n, rowIndex, colIndex)) {\r\n        // console.log('检查这个位置是否可以填', n)\r\n        continue\r\n      }\r\n      row[colIndex] = n\r\n      // console.log(row)\r\n      // 去下一行填写 n, 如果没填进去, 就继续寻找当前行下一个位置\r\n      // 当前行填写 n 成功, 递归调用 fillRow() 来在下一行中填写 n\r\n      if (!this.fillRow(n, rowIndex + 1)) {\r\n        // console.log('返回false', n , rowIndex + 1)\r\n        row[colIndex] = 0\r\n        continue\r\n      }\r\n      return true\r\n    }\r\n    return false\r\n  }\r\n}\r\n\r\nmodule.exports = Generator\r\n\r\n","// 生成数独游戏\r\n// 1.生成完成的解决方案, Generator\r\n// 2.随机去除部分数据: 按比例\r\n\r\nconst Generator = require('./generator.js')\r\n\r\nmodule.exports = class Sudoku {\r\n  constructor() {\r\n    // 生成完成的解决方案\r\n    const genterator = new Generator()\r\n    genterator.generate()\r\n    this.solutionMatrix = genterator.matrix\r\n  }\r\n\r\n  make(level = 5) {\r\n    // const shouldRid = Math.random() * 9 < level\r\n    // 生成迷盘\r\n    this.puzzleMatrix = this.solutionMatrix.map(row => {\r\n      return row.map(cell => Math.random() * 9 < level ? 0 : cell)\r\n    })\r\n  }\r\n}\r\n","const matrixToolkit = {\r\n  makeRow(v = 0) {\r\n    const array = new Array(9)\r\n    array.fill(v)\r\n    return array\r\n  },\r\n\r\n  makeMatrix(v = 0) {\r\n    return Array.from({length: 9}, () => this.makeRow(v))\r\n  },\r\n\r\n  /**\r\n   * Fisher-Yates 洗牌算法\r\n   */\r\n  shuffle(array) {\r\n    const endIndex = array.length - 2  // 7\r\n    for (let i = 0; i <= endIndex; i++) {\r\n      const j = i + Math.floor(Math.random() * (array.length - i))\r\n      ;[array[i], array[j]] = [array[j], array[i]]\r\n    }\r\n    return array\r\n  },\r\n\r\n  /**\r\n   *\r\n   *  检查指定位置可以填写数字 n\r\n   */\r\n  checkFillable(matrix, n, rowIndex, colIndex) {\r\n    const row = matrix[rowIndex]\r\n    const column = this.makeRow().map((v, i) => matrix[i][colIndex])\r\n    const { boxIndex } = boxToolkit.convertToBoxIndex(rowIndex, colIndex)\r\n    const box = boxToolkit.getBoxCells(matrix, boxIndex)\r\n    for (let i = 0; i < 9; i++) {\r\n      if (row[i] === n || column[i] === n || box[i] === n) {\r\n        return false\r\n      }\r\n    }\r\n    return true\r\n  }\r\n}\r\n\r\nconst boxToolkit = {\r\n  getBoxCells(matrix, boxIndex) {\r\n    const startRowIndex = Math.floor(boxIndex / 3) * 3\r\n    const startColIndex = boxIndex % 3 * 3\r\n    const result = []\r\n    for (let cellIndex = 0; cellIndex < 9; cellIndex++) {\r\n      const rowIndex = startRowIndex + Math.floor(cellIndex / 3)\r\n      const colIndex = startColIndex + cellIndex % 3\r\n      result.push(matrix[rowIndex][colIndex])\r\n    }\r\n    return result\r\n  },\r\n  convertToBoxIndex(rowIndex, colIndex) {\r\n    return {\r\n      boxIndex: Math.floor(rowIndex / 3) * 3 + Math.floor(colIndex / 3),\r\n      cellIndex: rowIndex % 3 * 3 + colIndex % 3\r\n    }\r\n  },\r\n  convertFromBoxIndex(boxIndex, cellIndex) {\r\n    return {\r\n      rowIndex: Math.floor(boxIndex / 3) * 3 + Math.floor(cellIndex / 3),\r\n      colIndex: boxIndex % 3 * 3 + cellIndex % 3\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = class Toolkit {\r\n  /**\r\n   * 矩阵和数据相关的工具\r\n   *\r\n   */\r\n  static get matrix() {\r\n    return matrixToolkit\r\n  }\r\n  static get box() {\r\n    return boxToolkit\r\n  }\r\n}\r\n\r\n","// 生成九宫格\r\nconst ToolKit = require('../core/toolkit.js')\r\nconst Generator = require('../core/generator.js')\r\nconst Sudoku = require('../core/sudoku.js')\r\nconst Checker = require('../core/checker.js')\r\n\r\nmodule.exports = class Grid {\r\n  constructor(container) {\r\n    this._$container = container\r\n  }\r\n  build() {\r\n    // const generator = new Generator()\r\n    // generator.generate()\r\n    // const matrix = generator.matrix\r\n\r\n    // const matrix = ToolKit.matrix.makeMatrix()\r\n    // console.log(matrix)  9 * 9 值都是0的矩阵\r\n\r\n    const sudoku = new Sudoku()\r\n    sudoku.make()\r\n    const matrix = sudoku.puzzleMatrix\r\n    // const matrix = sudoku.solutionMatrix\r\n\r\n    const rowGroupClasses = ['row_g_top', 'row_g_middle', 'row_g_bottom']\r\n    const colGroupClasses = ['col_g_left', 'col_g_center', 'col_g_right']\r\n\r\n    const $cells = matrix.map(rowValues => rowValues.map((cellValue, colIndex) => {\r\n      return $('<span>')\r\n        .addClass(colGroupClasses[colIndex % 3])\r\n        .addClass(cellValue ? 'fixed' : 'empty')\r\n        .text(cellValue)\r\n    }))\r\n    // console.log('$cells', $cells)  每个0 被替换成 span\r\n    const $divArray = $cells.map(($spanArray, rowIndex) => {\r\n      return $('<div>')\r\n        .addClass('row')\r\n        .addClass(rowGroupClasses[rowIndex % 3])\r\n        .append($spanArray)\r\n    })\r\n    // console.log('$divArray', $divArray) 每一行 被一个div包裹\r\n\r\n    this._$container.append($divArray)\r\n  }\r\n\r\n  layout() {\r\n    const width = $('span:first', this._$container).width()\r\n\r\n    $('span', this._$container)\r\n      .height(width)\r\n      .css({\r\n        'line-height': `${width}px`,\r\n        'font-size': width < 32 ? `${width / 2}px` : ''\r\n      })\r\n\r\n    // $(this._$container).height(width)\r\n  }\r\n\r\n  bindPopup(popupNumbers) { // popupNumbers 弹出盘\r\n    this._$container.on('click', 'span', e => {\r\n      const $cell = $(e.target) // $cell 每一个迷盘中的数字\r\n      if ($cell.is('.fixed')) {\r\n        return\r\n      }\r\n      popupNumbers.popup($cell)\r\n    })\r\n  }\r\n\r\n  /**\r\n   * 重建新的迷盘, 开启新一局\r\n   */\r\n  rebuild() {\r\n    this._$container.empty()\r\n    this.build()\r\n    this.layout()\r\n  }\r\n\r\n  /**\r\n   * 检查用户解迷的结果, 成功则进行提示, 失败显示错误位置的标记\r\n   */\r\n  check() {\r\n    // 从界面获取需要检查的数据\r\n    const data = this._$container.children().map((rowIndex, div) => {\r\n      return $(div).children().map((colIndex, span) => parseInt($(span).text()) || 0)\r\n    }).toArray().map($data => $data.toArray())\r\n\r\n    console.log(data)\r\n    const checker = new Checker(data)\r\n    if (checker.check()) {\r\n      return true\r\n    }\r\n\r\n    // 检查不成功, 进行标记\r\n    const marks = checker.matrixMarks\r\n    this._$container.children()\r\n      .each((rowIndex, div) => {\r\n        $(div).children().each((colIndex, span) => {\r\n          const $span = $(span)\r\n          if ($span.is('.fixed') || marks[rowIndex][colIndex]) {\r\n            $span.removeClass('error')\r\n          } else {\r\n            $span.addClass('error')\r\n          }\r\n        })\r\n      })\r\n  }\r\n\r\n  /**\r\n   * 重置当前迷盘到初始状态\r\n   */\r\n  reset() {\r\n    this._$container.find('span:not(.fixed)')\r\n      .removeClass('error mark1 mark2')\r\n      .addClass('empty')\r\n      .text(0)\r\n  }\r\n\r\n  /**\r\n   * 清理错误标记\r\n   */\r\n  clear() {\r\n    this._$container.find('span.error')\r\n      .removeClass('error')\r\n  }\r\n}\r\n","// 处理弹出的操作面板\r\n\r\n// cell --(click) --> popup\r\n// popup --(click)--> n --(fill)--> cell\r\n\r\nmodule.exports = class PopupNumbers {\r\n  constructor($panel) {\r\n    this._$panel = $panel.hide().removeClass('hidden')\r\n\r\n    this._$panel.on('click', 'span', e => {\r\n      const $cell = this._$targetCell // 点击迷盘的数字框\r\n      const $span = $(e.target)   // 弹出盘 的数字\r\n      if ($span.hasClass('mark1')) {\r\n        // mark1 回填样式\r\n        if ($cell.hasClass('mark1')) {\r\n          $cell.removeClass('mark1')\r\n        } else {\r\n          $cell.removeClass('mark2').addClass('mark1')\r\n        }\r\n      } else if ($span.hasClass('mark2')) {\r\n        // mark2 回填样式\r\n        if ($cell.hasClass('mark2')) {\r\n          $cell.removeClass('mark2')\r\n        } else {\r\n          $cell.removeClass('mark1').addClass('mark2')\r\n        }\r\n      } else if ($span.hasClass('empty')) {\r\n        // empty 取消数字填写, 取消 mark 样式\r\n        $cell.text(0).addClass('empty')\r\n      } else {\r\n        // 1-9 回填数字\r\n        $cell.removeClass('empty').text($span.text())\r\n      }\r\n      this.hide()\r\n    })\r\n  }\r\n\r\n  popup($cell) {  // $cell 每一个迷盘中的数字\r\n    this._$targetCell = $cell\r\n    const { left, top } = $cell.position()\r\n    const bodyWidth = $(document.body).width()\r\n    // console.log(left, this._$panel.width(), left + this._$panel.width())\r\n    if (left + this._$panel.width() > bodyWidth) {\r\n      this._$panel.css({\r\n        right: 0,\r\n        top: `${top}px`,\r\n        left: 'initial'\r\n      }).show()\r\n    } else {\r\n      this._$panel.css({\r\n        left: `${left}px`,\r\n        top: `${top}px`\r\n      }).show()\r\n    }\r\n  }\r\n\r\n  hide() {\r\n    this._$panel.hide()\r\n  }\r\n}\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n"],"sourceRoot":""}